(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{70:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return r})),a.d(t,"metadata",(function(){return o})),a.d(t,"rightToc",(function(){return c})),a.d(t,"default",(function(){return b}));var n=a(2),l=a(6),i=(a(0),a(90)),r={title:"i18n",slug:"/guides/i18n"},o={unversionedId:"5_Guides/5_2_i18n",id:"5_Guides/5_2_i18n",isDocsHomePage:!1,title:"i18n",description:"We built this application with internationalization in mind (I don't need i18n).",source:"@site/docs/5_Guides/5_2_i18n.md",slug:"/guides/i18n",permalink:"/symfony-boilerplate/docs/guides/i18n",editUrl:"https://github.com/thecodingmachine/symfony-boilerplate/docs/5_Guides/5_2_i18n.md",version:"current",sidebar:"docs",previous:{title:"GraphQL",permalink:"/symfony-boilerplate/docs/guides/graphql"},next:{title:"Security",permalink:"/symfony-boilerplate/docs/guides/security"}},c=[{value:"Default locale",id:"default-locale",children:[]},{value:"API",id:"api",children:[{value:"Basic usage",id:"basic-usage",children:[]},{value:"Translations folder",id:"translations-folder",children:[]},{value:"Validation error messages",id:"validation-error-messages",children:[]},{value:"Emails",id:"emails",children:[]},{value:"Spreadsheets",id:"spreadsheets",children:[]}]},{value:"Web application",id:"web-application",children:[{value:"Basic usage",id:"basic-usage-1",children:[]},{value:"Locales folder",id:"locales-folder",children:[]},{value:"Browser language detection",id:"browser-language-detection",children:[]},{value:"Routing",id:"routing",children:[]},{value:"Update the locale",id:"update-the-locale",children:[]}]},{value:"Interactions between the web application and the API",id:"interactions-between-the-web-application-and-the-api",children:[{value:"HTTP header",id:"http-header",children:[]},{value:"Query parameters",id:"query-parameters",children:[]},{value:"Update the authenticated user&#39;s locale",id:"update-the-authenticated-users-locale",children:[]}]},{value:"I don&#39;t need i18n",id:"i-dont-need-i18n",children:[]}],s={rightToc:c};function b(e){var t=e.components,a=Object(l.a)(e,["components"]);return Object(i.b)("wrapper",Object(n.a)({},s,a,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"We built this application with internationalization in mind (",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"#i-dont-need-i18n"}),"I don't need i18n"),")."),Object(i.b)("h2",{id:"default-locale"},"Default locale"),Object(i.b)("p",null,"Both the ",Object(i.b)("inlineCode",{parentName:"p"},"webapp")," and ",Object(i.b)("inlineCode",{parentName:"p"},"api")," services read the ",Object(i.b)("inlineCode",{parentName:"p"},"DEFAULT_LOCALE")," environment variable."),Object(i.b)("p",null,"Its value comes from the root ",Object(i.b)("em",{parentName:"p"},".env")," file."),Object(i.b)("p",null,"If you update this value, you will have to restart these services (locally by doing ",Object(i.b)("inlineCode",{parentName:"p"},"make down up"),")."),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"\ud83d\udce3","\xa0","\xa0","Don't forget to update the file ",Object(i.b)("em",{parentName:"p"},".env.dist")," if this change is definitive."))),Object(i.b)("h2",{id:"api"},"API"),Object(i.b)("p",null,"For the API, i18n has three goals:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"Translate the validation error messages."),Object(i.b)("li",{parentName:"ol"},"Translate the emails."),Object(i.b)("li",{parentName:"ol"},"Translate the spreadsheets.")),Object(i.b)("p",null,"The ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://symfony.com/doc/current/translation.html"}),"symfony/translation")," package helps us for that task."),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"\ud83d\udce3","\xa0","\xa0","It requires the PHP extension ",Object(i.b)("inlineCode",{parentName:"p"},"intl"),", already configured in the ",Object(i.b)("inlineCode",{parentName:"p"},"api")," service."))),Object(i.b)("h3",{id:"basic-usage"},"Basic usage"),Object(i.b)("p",null,"Symfony provides a ",Object(i.b)("inlineCode",{parentName:"p"},"TranslatorInterface")," you can inject in your class, i.e.:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-php"}),"# A class.\nprivate TranslatorInterface $translator;\n\npublic function __construct(\n    TranslatorInterface $translator\n) {\n    $this->translator = $translator;\n}\n")),Object(i.b)("p",null,"You can then use it as below:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-php"}),"$translatedSubject = $this->translator\n    ->trans(\n        'translation_key',\n        [],\n        'the_domain', // More on that later.\n        'the_locale'\n    );\n")),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"\ud83d\udce3","\xa0","\xa0","Most of the time, you don't have to use the ",Object(i.b)("inlineCode",{parentName:"p"},"TranslatorInterface")," as either Symfony or the parent class call it for you."))),Object(i.b)("h3",{id:"translations-folder"},"Translations folder"),Object(i.b)("p",null,"Folder ",Object(i.b)("em",{parentName:"p"},"src/api/translations")," contains one YAML file per locale and domain."),Object(i.b)("p",null,"A domain is a sort of scope. For instance, ",Object(i.b)("em",{parentName:"p"},"src/api/translations/emails.en.yaml")," and ",Object(i.b)("em",{parentName:"p"},"src/api/translations/emails.fr.yaml"),"\nare both for the ",Object(i.b)("inlineCode",{parentName:"p"},"email")," domain (used for translating emails!)."),Object(i.b)("p",null,"Each of these files contains translation keys and the associated texts."),Object(i.b)("p",null,"For instance:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-yaml",metastring:'title="src/api/translations/foo.en.yaml"',title:'"src/api/translations/foo.en.yaml"'}),'foo:\n  baz: "Hello"\n')),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"\ud83d\udce3","\xa0","\xa0","All files from the same domain should have the same organization (same translations keys, identical sorting, etc.)."))),Object(i.b)("h3",{id:"validation-error-messages"},"Validation error messages"),Object(i.b)("p",null,"Let's say you have a class with the following validation annotations:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-php",metastring:'title="src/api/src/Domain/Model/User.php"',title:'"src/api/src/Domain/Model/User.php"'}),'/**\n * @Field\n * @Assert\\NotBlank(message="not_blank")\n * @Assert\\Length(max=255, maxMessage="max_length_255")\n */\npublic function getFirstName(): string\n{\n    return parent::getFirstName();\n}\n')),Object(i.b)("p",null,"The ",Object(i.b)("inlineCode",{parentName:"p"},"message")," property of each ",Object(i.b)("inlineCode",{parentName:"p"},"Assert")," annotation is a translation key from the ",Object(i.b)("inlineCode",{parentName:"p"},"validators")," domain:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-yaml",metastring:'title="src/api/translations/validators.en.yaml"',title:'"src/api/translations/validators.en.yaml"'}),'not_blank: "This value should not be blank."\nmax_length_255: "This value is too long. It should have 255 characters or less."\n')),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-yaml",metastring:'title="src/api/translations/validators.fr.yaml"',title:'"src/api/translations/validators.fr.yaml"'}),'not_blank: "Cette valeur ne doit pas \xeatre vide."\nmax_length_255: "Cette valeur est trop longue. Elle doit avoir 255 caract\xe8res ou moins."\n')),Object(i.b)("p",null,"The web application implements a mechanism for setting the correct locale to translate these validation error\nmessages (see ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"#interactions-between-the-web-application-and-the-api"}),"interactions between the web application and the API chapter"),")."),Object(i.b)("h3",{id:"emails"},"Emails"),Object(i.b)("p",null,"Emails translation uses the ",Object(i.b)("inlineCode",{parentName:"p"},"emails")," domain. The corresponding YAML files are:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("em",{parentName:"li"},"src/api/translations/emails.en.yaml")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("em",{parentName:"li"},"src/api/translations/emails.fr.yaml"))),Object(i.b)("p",null,"Let's take a look at the ",Object(i.b)("inlineCode",{parentName:"p"},"CreateEmail")," use case:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-php",metastring:'title="src/api/src/UseCase/CreateEmail.php"',title:'"src/api/src/UseCase/CreateEmail.php"'}),"protected function create(User $user, string $subjectId, string $template, array $context): TemplatedEmail\n")),Object(i.b)("p",null,"The method ",Object(i.b)("inlineCode",{parentName:"p"},"create")," takes, among other arguments, a ",Object(i.b)("em",{parentName:"p"},"src/api/src/Domain/Model/User.php")," and the translation key\nof the email's subject. The ",Object(i.b)("inlineCode",{parentName:"p"},"User")," has a ",Object(i.b)("inlineCode",{parentName:"p"},"locale")," property used for translating both the email's subject and its content."),Object(i.b)("p",null,"See the ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"emails"}),"emails")," documentation for more details on how to extend this use case."),Object(i.b)("p",null,"The Twig templates of your emails should look like this:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-twig",metastring:'title="src/api/templates/emails/foo.html.twig"',title:'"src/api/templates/emails/foo.html.twig"'}),"{% extends 'emails/email.html.twig' %}\n{% trans_default_domain domain %}\n\n{% block body %}\n    {% apply inky_to_html|inline_css(source('@css/foundation-emails.css'), source('@css/emails.css')) %}\n        <h1>{% trans into locale %}translation_key{% endtrans %}</h1>\n   {% endapply %}\n{% endblock %}\n")),Object(i.b)("p",null,"The ",Object(i.b)("inlineCode",{parentName:"p"},"CreateEmail")," use case will provide both ",Object(i.b)("inlineCode",{parentName:"p"},"domain")," and ",Object(i.b)("inlineCode",{parentName:"p"},"locale")," values."),Object(i.b)("h3",{id:"spreadsheets"},"Spreadsheets"),Object(i.b)("p",null,"Spreadsheets translation uses the ",Object(i.b)("inlineCode",{parentName:"p"},"spreadsheets")," domain. The corresponding YAML files are:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("em",{parentName:"li"},"src/api/translations/spreadsheets.en.yaml")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("em",{parentName:"li"},"src/api/translations/spreadsheets.fr.yaml"))),Object(i.b)("p",null,"As you might want to translate the headers and cell values of your XLSX exports, the boilerplate provides examples\non how of do so."),Object(i.b)("p",null,"Let's take a look at the ",Object(i.b)("inlineCode",{parentName:"p"},"CreateXLSXExport")," use case:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-php",metastring:'title="src/api/src/UseCase/CreateXLSXExport.php"',title:'"src/api/src/UseCase/CreateXLSXExport.php"'}),"public function create(string $locale, array $headerIds, array $values): Xlsx\n")),Object(i.b)("p",null,"The method ",Object(i.b)("inlineCode",{parentName:"p"},"create")," takes, among other arguments, a locale. It will use it to translates the spreadsheet's headers\naccordingly."),Object(i.b)("p",null,"For values, you should translate them directly in your UseCase before calling the ",Object(i.b)("inlineCode",{parentName:"p"},"create")," method."),Object(i.b)("h2",{id:"web-application"},"Web application"),Object(i.b)("p",null,"For the web application, i18n has two goals:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"Translate the user interface."),Object(i.b)("li",{parentName:"ol"},"Tell the API which locale the user has selected (for validations errors, etc.).")),Object(i.b)("p",null,"We use the ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://i18n.nuxtjs.org/"}),"nuxt/i18n")," module, and we configured it in\nthe ",Object(i.b)("em",{parentName:"p"},"src/webapp/nuxt.config.js")," file."),Object(i.b)("h3",{id:"basic-usage-1"},"Basic usage"),Object(i.b)("p",null,"In your ",Object(i.b)("inlineCode",{parentName:"p"},"<script>")," blocks:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),"this.$t('a_translation_key')\n")),Object(i.b)("p",null,"In your ",Object(i.b)("inlineCode",{parentName:"p"},"<template>")," blocks:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-vue"}),"<template>\n  <button>\n    {{ $t('a_translation_key') }}\n  </button>\n</template>\n")),Object(i.b)("h3",{id:"locales-folder"},"Locales folder"),Object(i.b)("p",null,"Folder ",Object(i.b)("em",{parentName:"p"},"src/webapp/locales")," contains one JavaScript file per locale."),Object(i.b)("p",null,"Each of these files exports an object with translation keys and the associated texts."),Object(i.b)("p",null,"For instance:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js",metastring:'title="src/webapp/en.js"',title:'"src/webapp/en.js"'}),"export default {\n  foo: {\n    baz: 'Hello',\n  },\n}\n")),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"\ud83d\udce3","\xa0","\xa0","All files should have the same organization (same translations keys, identical sorting, etc.)."))),Object(i.b)("p",null,"It would be best to organize the translations keys according to the file's path where you've put them."),Object(i.b)("p",null,"If the file content is lengthy, append the most relevant component from the ",Object(i.b)("inlineCode",{parentName:"p"},"<template>")," block."),Object(i.b)("p",null,"For instance:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-vue",metastring:'title="src/webapp/pages/login.vue"',title:'"src/webapp/pages/login.vue"'}),"<template>\n  <form>\n    <button>\n      {{ $t('pages.login.form.submit') }}\n    </button>\n  </form>\n</template>\n")),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js",metastring:'title="src/webapp/locales/en.js"',title:'"src/webapp/locales/en.js"'}),"export default {\n  pages: {\n    login: {\n      form: {\n        submit: 'Send',\n      },\n    },\n  },\n}\n")),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js",metastring:'title="src/webapp/locales/fr.js"',title:'"src/webapp/locales/fr.js"'}),"export default {\n  pages: {\n    login: {\n      form: {\n        submit: 'Envoyer',\n      },\n    },\n  },\n}\n")),Object(i.b)("p",null,"If you are using the same translations in different files, you may put them under the ",Object(i.b)("inlineCode",{parentName:"p"},"common")," key:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js",metastring:'title="src/webapp/locales/en.js"',title:'"src/webapp/locales/en.js"'}),"export default {\n  common: {\n    first_name: 'First name',\n    last_name: 'Last name',\n    email: 'Email',\n    locale: 'Locale',\n    role: 'Role',\n  },\n}\n")),Object(i.b)("h3",{id:"browser-language-detection"},"Browser language detection"),Object(i.b)("p",null,"The first time the user lands on your application's root pages (",Object(i.b)("inlineCode",{parentName:"p"},"/x"),", but not ",Object(i.b)("inlineCode",{parentName:"p"},"/x/y"),"), it automatically detects the\nbrowser language and sets the cookie ",Object(i.b)("inlineCode",{parentName:"p"},"i18n_redirected")," with the corresponding locale. "),Object(i.b)("p",null,"If your application does not support the browser language, it uses the default locale instead."),Object(i.b)("p",null,"Next time the user lands on your application, it will use cookie ",Object(i.b)("inlineCode",{parentName:"p"},"i18n_redirected"),"'s value to translate the\nuser interface to the correct locale automatically (and redirect the user to the right path - see below)."),Object(i.b)("h3",{id:"routing"},"Routing"),Object(i.b)("p",null,"The router prefixes all routes with the locale. For instance, the login page is available on the paths ",Object(i.b)("inlineCode",{parentName:"p"},"/en/login")," and\n",Object(i.b)("inlineCode",{parentName:"p"},"/fr/login"),"."),Object(i.b)("p",null,"Wherever you need to push a route in your router, use the global method ",Object(i.b)("inlineCode",{parentName:"p"},"localePath({ name: 'route_name' })"),"."),Object(i.b)("p",null,"For instance, in your ",Object(i.b)("inlineCode",{parentName:"p"},"<script>")," blocks:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),"this.$router.push(this.localePath({ name: 'index' }))\n")),Object(i.b)("p",null,"Or in your ",Object(i.b)("inlineCode",{parentName:"p"},"<template>")," blocks:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-vue"}),"<template>\n  <b-link :to=\"localePath({ name: 'reset-password', query: { email: form.email } })\">\n    {{ $t('pages.login.form.forgot_password_link') }}\n  </b-link>\n</template>\n")),Object(i.b)("p",null,"If you don't know the name of your route, take a look at the router file Nuxt.js generates:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js",metastring:'title="src/webapp/.nuxt/router.js"',title:'"src/webapp/.nuxt/router.js"'}),'{\n  path: "/fr/update-password/:id?/:token",\n  component: _8474331c,\n  name: "update-password-id-token___fr"\n}\n')),Object(i.b)("p",null,"The name of the route here is ",Object(i.b)("inlineCode",{parentName:"p"},"update-password-id-token"),"."),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"\ud83d\udce3","\xa0","\xa0","If a route has parameters, you have to give them to the ",Object(i.b)("inlineCode",{parentName:"p"},"localePath")," method."))),Object(i.b)("h3",{id:"update-the-locale"},"Update the locale"),Object(i.b)("p",null,"The file ",Object(i.b)("em",{parentName:"p"},"src/webapp/components/layouts/Header.vue")," provides an example of how to update the locale:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-vue",metastring:'title="src/webapp/components/layouts/Header.vue"',title:'"src/webapp/components/layouts/Header.vue"'}),'<template>\n <b-nav-item-dropdown right>\n  <template #button-content>\n    {{ currentLocale }}\n  </template>\n  <b-dropdown-item\n    v-for="locale in availableLocales"\n    :key="locale.code"\n    :active="locale.code === currentLocale"\n    :to="switchLocalePath(locale.code)"\n  >\n    {{ locale.code }}\n  </b-dropdown-item>\n </b-nav-item-dropdown>\n</template>\n\n<script>\nexport default {\n  computed: {\n    availableLocales() {\n      return this.$i18n.locales.filter((i) => i.code !== this.$i18n.locale)\n    },\n    currentLocale() {\n      return this.$i18n.locale\n    },\n  },\n}\n<\/script>\n')),Object(i.b)("p",null,"Here calling ",Object(i.b)("inlineCode",{parentName:"p"},"switchLocalePath")," will update the current locale in the ",Object(i.b)("inlineCode",{parentName:"p"},"i18n")," store (from nuxt-i18n),\nplus the value of the cookie ",Object(i.b)("inlineCode",{parentName:"p"},"i18_redirected"),". It will also redirect the user to the correct route."),Object(i.b)("p",null,"Our custom plugin ",Object(i.b)("em",{parentName:"p"},"src/webapp/plugins/i18n.js")," hooks itself on these events for:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"Updating the HTTP header ",Object(i.b)("inlineCode",{parentName:"li"},"Accept-Language")," for next GraphQL requests (more on that in the next chapter)."),Object(i.b)("li",{parentName:"ol"},"Updating the user's locale in the database if authenticated.")),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"\ud83d\udce3","\xa0","\xa0","We configured nuxt-i18n to lazy load the locales files, meaning it will only load the current locale file\ninstead of all locales files. You may have to refresh a page in development to see changes made in the corresponding\nlocale file."))),Object(i.b)("h2",{id:"interactions-between-the-web-application-and-the-api"},"Interactions between the web application and the API"),Object(i.b)("p",null,"There are three ways for communicating the user locale from the web application to the API:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"Requests with ",Object(i.b)("inlineCode",{parentName:"li"},"Accept-Language")," HTTP header for validation error messages."),Object(i.b)("li",{parentName:"ol"},"Query parameters when you cannot set the previous HTTP header (links, for instance)."),Object(i.b)("li",{parentName:"ol"},"Update the user's locale via a GraphQL request if authenticated."),Object(i.b)("li",{parentName:"ol"},"Update the user's locale on login if the web application locale is not the same as the locale from the API")),Object(i.b)("h3",{id:"http-header"},"HTTP header"),Object(i.b)("p",null,"Use case: translating the validation error messages."),Object(i.b)("p",null,"Each time the user changes its locale on the web application, the ",Object(i.b)("em",{parentName:"p"},"src/webapp/plugins/i18n.js")," plugin will\nupdate the HTTP header ",Object(i.b)("inlineCode",{parentName:"p"},"Accept-Language")," for the next GraphQL requests with the new value."),Object(i.b)("p",null,"The ",Object(i.b)("em",{parentName:"p"},"src/api/src/Infrastructure/EventSubscriber/LocaleSubscriber.php")," class\nfrom the API reads the value of this HTTP header to set the locale on its side."),Object(i.b)("h3",{id:"query-parameters"},"Query parameters"),Object(i.b)("p",null,"In some use cases, you cannot set an HTTP header. For instance, when the user clicks on a link, you will have to use\nquery parameters:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{}),"http://foo.bar/?locale=fr\n")),Object(i.b)("p",null,"In the boilerplate, we use this solution for XLSX exports."),Object(i.b)("h3",{id:"update-the-authenticated-users-locale"},"Update the authenticated user's locale"),Object(i.b)("p",null,"As explained before, whenever an authenticated user changes the locale on the web application, we run the\n",Object(i.b)("inlineCode",{parentName:"p"},"updateLocale")," GraphQL mutation. "),Object(i.b)("p",null,"In the API, the ",Object(i.b)("inlineCode",{parentName:"p"},"UpdateLocale")," use case updates the ",Object(i.b)("inlineCode",{parentName:"p"},"locale")," property of this user."),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"\ud83d\udce3","\xa0","\xa0","This property helps to know in which locale the API has to translate emails for this user."))),Object(i.b)("p",null,"We also call the ",Object(i.b)("inlineCode",{parentName:"p"},"updateLocale")," GraphQL mutation on page ",Object(i.b)("em",{parentName:"p"},"src/webapp/pages/login.vue"),"\nin the specific scenario where the web application locale is not the same as the user's locale from the API."),Object(i.b)("h2",{id:"i-dont-need-i18n"},"I don't need i18n"),Object(i.b)("p",null,"No problem! Remove the web application's locale selection (",Object(i.b)("em",{parentName:"p"},"src/webapp/components/layouts/Header.vue"),")\nand set the ",Object(i.b)("inlineCode",{parentName:"p"},"DEFAULT_LOCALE")," environment variable with your unique locale (see ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"#default-locale"}),"default locale")," chapter)."))}b.isMDXComponent=!0},90:function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return u}));var n=a(0),l=a.n(n);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var s=l.a.createContext({}),b=function(e){var t=l.a.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},p=function(e){var t=b(e.components);return l.a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return l.a.createElement(l.a.Fragment,{},t)}},m=l.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,r=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),p=b(a),m=n,u=p["".concat(r,".").concat(m)]||p[m]||d[m]||i;return a?l.a.createElement(u,o(o({ref:t},s),{},{components:a})):l.a.createElement(u,o({ref:t},s))}));function u(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,r=new Array(i);r[0]=m;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o.mdxType="string"==typeof e?e:n,r[1]=o;for(var s=2;s<i;s++)r[s]=a[s];return l.a.createElement.apply(null,r)}return l.a.createElement.apply(null,a)}m.displayName="MDXCreateElement"}}]);